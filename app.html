<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>TEST GPS</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body style="background:#000; color:#fff; text-align:center; padding-top:50px;">
    <h2>TEST INVIO GPS</h2>
    <p id="stato">In attesa di comando...</p>
    <button onclick="test()" style="padding:20px; font-size:20px;">PREMI PER INVIARE GPS</button>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
    import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";

    // USA I TUOI DATI REALI QUI SOTTO
    const cfg = { 
        apiKey: "AIzaSyAWHRpXkth-UrnaDVo7GyeFNXpu10_fd54", 
        databaseURL: "https://realtime-database-6962f-default-rtdb.firebaseio.com" 
    };
    const app = initializeApp(cfg);
    const db = getDatabase(app);

    window.test = () => {
        document.getElementById('stato').innerText = "Cerco GPS...";
        
        navigator.geolocation.getCurrentPosition((p) => {
            const lat = p.coords.latitude;
            const lng = p.coords.longitude;
            document.getElementById('stato').innerText = "GPS trovato! Invio...";

            push(ref(db, 'brogliaccio'), {
                ora: new Date().toLocaleTimeString(),
                squadra: "TEST_REALE",
                m1: "TEST POSIZIONE FUNZIONANTE",
                lat: lat,
                lng: lng,
                dir: 'SQ'
            }).then(() => {
                document.getElementById('stato').innerText = "INVIATO AL DATABASE!";
                Swal.fire("SUCCESSO", "Controlla la Dashboard ora!", "success");
            });
        }, (err) => {
            document.getElementById('stato').innerText = "ERRORE GPS: " + err.message;
            alert("Errore GPS: " + err.message);
        }, { enableHighAccuracy: true });
    };
</script>
</body>
</html>
